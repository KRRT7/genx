<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>A model for fitting the spectral response &#8212; GenX 2.4.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.6/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.4.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/genx.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          GenX</a>
        <span class="navbar-text navbar-version pull-left"><b>2.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Content <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#windows">Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#mac-os-x">Mac OS-X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#from-source">From source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#reflectivity">Reflectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#surface-x-ray-diffraction">Surface x-ray diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#other-tutorials">Other tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#fitting">Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#reflectivity">Reflectivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html">Data classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_data_loader.html">How to write a Data Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_fom.html">Writing a FOM function</a></li>
<li class="toctree-l2"><a class="reference internal" href="packaging.html">How to package GenX</a></li>
<li class="toctree-l2"><a class="reference internal" href="mag_refl.html">A model for magnetic reflectivity</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">A model for fitting the spectral response</a><ul>
<li><a class="reference internal" href="#theory">Theory</a></li>
<li><a class="reference internal" href="#references">References:</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-genx.models.lib.xmcd_moment">
<span id="a-model-for-fitting-the-spectral-response"></span><span id="moment-analysis"></span><h1>A model for fitting the spectral response<a class="headerlink" href="#module-genx.models.lib.xmcd_moment" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-xmcd_moment"></span><p>This module provides he framework to model the spectroscopic response of the scattering lengths
around an 2p absorption edge. The approach was first presented by van der Laan <a class="reference internal" href="#laan97" id="id1">[Laan97]</a> for modelling the line shape
of the XMCD (x-ray magnetic circular dichrosim) spectrum of the 3d metals and later used experimentally by
Gold, Bayer and Goering <a class="reference internal" href="#gold04" id="id2">[Gold04]</a> for fitting XMCD spectra and extracting moments.</p>
<p>The ground state moment model has also been justified by Dörfler and Fähnle <a class="reference internal" href="#dorfler06" id="id3">[Dörfler06]</a>.</p>
<div class="section" id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h2>
<p>All the equation shown in this section are reproduced from <a class="reference internal" href="#laan97" id="id4">[Laan97]</a> if not otherwise stated.</p>
<p>The total intensity, <span class="math">\(I_{j,m}^{(r)}\)</span>, from an <span class="math">\(j,m\)</span> level  can be written as</p>
<div class="math">
\[I_{j,m}^{(a), \mathrm{tot}} = \sum_{x,y,z}  \left&lt;\underline{w}^{x,y,z}\right&gt; \sum_r C_j^{xyzar}
u_{jm}^r = \sum_{x,y,z}  \left&lt;\underline{w}^{x,y,z}\right&gt; h_{jm}^{xyza},\]</div>
<p>where <span class="math">\(C_j^{xyzar}\)</span> is the probability of creating a core hole <span class="math">\(j\)</span> with a multipole moment <span class="math">\(r\)</span> using
a polarised light that belongs to the ground state moment <span class="math">\(\left&lt;\underline{w}^{x,y,z}\right&gt;\)</span>. The underscore
signifies that the properties belong to the holes. The physical meaning of the different ground state moments can be
found in the table below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Ground state moment</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{000}\right&gt;\)</span></td>
<td>The number of holes, <span class="math">\(n_h\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{110}\right&gt;\)</span></td>
<td>Spin orbit coupling <span class="math">\(-\sum_i{l_i \dot s_i}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{101}\right&gt;\)</span></td>
<td>The orbital magnetic moment <span class="math">\(L_z/2\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{011}\right&gt;\)</span></td>
<td>The spin magnetic moment <span class="math">\(2S_z\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{211}\right&gt;\)</span></td>
<td>The &#8220;magnetic dipole&#8221; operator <span class="math">\(7T_z/2\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{202}\right&gt;\)</span></td>
<td>The quadrupole moment <span class="math">\(-Q_{zz}/2\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{112}\right&gt;\)</span></td>
<td>??</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{312}\right&gt;\)</span></td>
<td>??</td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{303}\right&gt;\)</span></td>
<td>??</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{213}\right&gt;\)</span></td>
<td>??</td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{413}\right&gt;\)</span></td>
<td>??</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{404}\right&gt;\)</span></td>
<td>??</td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{314}\right&gt;\)</span></td>
<td>??</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{415}\right&gt;\)</span></td>
<td>??</td>
</tr>
</tbody>
</table>
<p>Unpolarised light correspond to <span class="math">\(a = 0\)</span>, circular dichroism
correspond to <span class="math">\(a = 1\)</span> and linear dichroism to <span class="math">\(a = 2\)</span>. The values for <span class="math">\(h_{jm}^{xyza}\)</span> has been
tabulated in <a class="reference internal" href="#laan97" id="id5">[Laan97]</a> and can be found reproduced below.</p>
<p>Values for <span class="math">\(h_{jm}^{xyza}\)</span> for each ground state moment and j and light polarisation <span class="math">\(a\)</span>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="11%" />
<col width="11%" />
<col width="19%" />
<col width="12%" />
<col width="20%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head" colspan="2">a = 0</th>
<th class="head" colspan="2">a = 1</th>
<th class="head" colspan="2">a = 2</th>
</tr>
<tr class="row-even"><th class="head"><span class="math">\(\left&lt;\underline{w}^{xyz}\right&gt;\)</span></th>
<th class="head"><span class="math">\(j = \frac{3}{2}\)</span></th>
<th class="head"><span class="math">\(j = \frac{1}{2}\)</span></th>
<th class="head"><span class="math">\(j = \frac{3}{2}\)</span></th>
<th class="head"><span class="math">\(j = \frac{1}{2}\)</span></th>
<th class="head"><span class="math">\(j = \frac{3}{2}\)</span></th>
<th class="head"><span class="math">\(j = \frac{1}{2}\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{000}\right&gt;\)</span></td>
<td><span class="math">\(2u_{jm}^0\)</span></td>
<td><span class="math">\(u_{jm}^0\)</span></td>
<td><span class="math">\(\frac{5}{9}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{1}{3}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{1}{5}u_{jm}^2\)</span></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{110}\right&gt;\)</span></td>
<td><span class="math">\(u_{jm}^0\)</span></td>
<td><span class="math">\(-u_{jm}^0\)</span></td>
<td><span class="math">\(\frac{4}{9}u_{jm}^1\)</span></td>
<td><span class="math">\(-\frac{1}{3}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{2}{5}u_{jm}^2\)</span></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{101}\right&gt;\)</span></td>
<td><span class="math">\(\frac{5}{3}u_{jm}^1\)</span></td>
<td><span class="math">\(-u_{jm}^1\)</span></td>
<td><span class="math">\(2u_{jm}^0 + \frac{2}{5}u_{jm}^2\)</span></td>
<td><span class="math">\(u_{jm}^0\)</span></td>
<td><span class="math">\(\frac{2}{3}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{2}{5}u_{jm}^1\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{011}\right&gt;\)</span></td>
<td><span class="math">\(\frac{10}{9}u_{jm}^1\)</span></td>
<td><span class="math">\(u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{1}{3}u_{jm}^0 + \frac{2}{3}u_{jm}^2\)</span></td>
<td><span class="math">\(-\frac{1}{3}u_{jm}^0\)</span></td>
<td><span class="math">\(\frac{2}{45}u_{jm}^1 + \frac{3}{6}u_{jm}^3\)</span></td>
<td><span class="math">\(-\frac{2}{15}u_{jm}^1\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{211}\right&gt;\)</span></td>
<td><span class="math">\(\frac{2}{9}u_{jm}^1\)</span></td>
<td><span class="math">\(-\frac{1}{3}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{2}{3}u_{jm}^0 + \frac{2}{15}u_{jm}^2\)</span></td>
<td><span class="math">\(-\frac{2}{3}u_{jm}^0\)</span></td>
<td><span class="math">\(\frac{22}{45}u_{jm}^1 + \frac{6}{35}u_{jm}^3\)</span></td>
<td><span class="math">\(-\frac{4}{15}u_{jm}^1\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{202}\right&gt;\)</span></td>
<td><span class="math">\(u_{jm}^2\)</span></td>
<td><span class="math">\(-\frac{2}{3}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{10}{9}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{2}{3}u_{jm}^1\)</span></td>
<td><span class="math">\(2u_{jm}^0 + \frac{2}{7}u_{jm}^2\)</span></td>
<td><span class="math">\(u_{jm}^0\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{112}\right&gt;\)</span></td>
<td><span class="math">\(2u_{jm}^0\)</span></td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{34}{45}u_{jm}^1 + \frac{6}{5}u_{jm}^3\)</span></td>
<td><span class="math">\(-\frac{4}{15}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{2}{5}u_{jm}^0 + \frac{2}{5}u_{jm}^2\)</span></td>
<td><span class="math">\(-\frac{2}{5}u_{jm}^0\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{312}\right&gt;\)</span></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{2}{15}u_{jm}^1 + \frac{3}{35}u_{jm}^3\)</span></td>
<td><span class="math">\(-\frac{2}{5}u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{3}{5}u_{jm}^0 + \frac{6}{35}u_{jm}^2\)</span></td>
<td><span class="math">\(-\frac{3}{5}u_{jm}^0\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{303}\right&gt;\)</span></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{3}{5}u_{jm}^2\)</span></td>
<td>&nbsp;</td>
<td><span class="math">\(u_{jm}^1\)</span></td>
<td><span class="math">\(\frac{3}{5}u_{jm}^1\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{213}\right&gt;\)</span></td>
<td><span class="math">\(3u_{jm}^3\)</span></td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{6}{5}u_{jm}^2\)</span></td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{24}{35}u_{jm}^1 + \frac{24}{35}u_{jm}^3\)</span></td>
<td><span class="math">\(-\frac{9}{35}u_{jm}^1\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{413}\right&gt;\)</span></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{4}{35}u_{jm}^1 + \frac{4}{35}u_{jm}^3\)</span></td>
<td><span class="math">\(-\frac{12}{35}u_{jm}^1\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{404}\right&gt;\)</span></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{18}{35}u_{jm}^2\)</span></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><span class="math">\(\left&lt;\underline{w}^{314}\right&gt;\)</span></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{12}{7}u_{jm}^3\)</span></td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{36}{35}u_{jm}^2\)</span></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><span class="math">\(\left&lt;\underline{w}^{415}\right&gt;\)</span></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><span class="math">\(\frac{10}{7}u_{jm}^3\)</span></td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>The <span class="math">\(h_{jm}^{xyza}\)</span> expressions contain unevaluated <span class="math">\(u_{jm}^r\)</span> values.</p>
<div class="math">
\[\begin{split}u_{jm}^r = \left(2r + 1\right) n_{jr} (-)^{(j - m)} \left(\begin{matrix} j &amp; r &amp; j \\
-m &amp; 0 &amp; m \end{matrix}\right),\end{split}\]</div>
<p>where</p>
<div class="math">
\[\begin{split}n_{jr} = \left(\begin{matrix} j &amp; r &amp; j \\ -j &amp; 0 &amp; j \end{matrix}\right),\end{split}\]</div>
<p>is a normalisation factor. The symbols written out as matrices are Wigner 3j symbols. These have been evaluated using
RREF <a class="reference internal" href="#stone80" id="id6">[Stone80]</a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="16%" />
<col width="23%" />
<col width="24%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><span class="math">\(j\)</span></th>
<th class="head"><span class="math">\(n_{j0}\)</span></th>
<th class="head"><span class="math">\(n_{j1}\)</span></th>
<th class="head"><span class="math">\(n_{j2}\)</span></th>
<th class="head"><span class="math">\(n_{j3}\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(\frac{3}{2}\)</span></td>
<td><span class="math">\(\frac{1}{2}\)</span></td>
<td><span class="math">\(\frac{1}{2}\sqrt{\frac{3}{5}}\)</span></td>
<td><span class="math">\(\frac{1}{2}\sqrt{\frac{1}{5}}\)</span></td>
<td><span class="math">\(\frac{1}{2}\sqrt{\frac{1}{35}}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\frac{1}{2}\)</span></td>
<td><span class="math">\(\frac{1}{\sqrt{2}}\)</span></td>
<td><span class="math">\(\frac{1}{\sqrt{6}}\)</span></td>
<td><span class="math">\(0\)</span></td>
<td><span class="math">\(0\)</span></td>
</tr>
</tbody>
</table>
<p>Calculating the <span class="math">\(u_{jm}^r\)</span> for the different combinations of <span class="math">\(j\)</span>, <span class="math">\(m\)</span> and <span class="math">\(r\)</span> yields the
following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="18%" />
<col width="19%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><span class="math">\(j, m\)</span></th>
<th class="head"><span class="math">\(u_{jm}^0\)</span></th>
<th class="head"><span class="math">\(u_{jm}^1\)</span></th>
<th class="head"><span class="math">\(u_{jm}^2\)</span></th>
<th class="head"><span class="math">\(u_{jm}^3\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math">\(\frac{3}{2}, -\frac{3}{2}\)</span></td>
<td><span class="math">\(\frac{1}{4}\)</span></td>
<td><span class="math">\(-\frac{9}{20}\)</span></td>
<td><span class="math">\(\frac{1}{4}\)</span></td>
<td><span class="math">\(-\frac{1}{20}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\frac{3}{2}, -\frac{1}{2}\)</span></td>
<td><span class="math">\(\frac{1}{4}\)</span></td>
<td><span class="math">\(-\frac{3}{20}\)</span></td>
<td><span class="math">\(-\frac{1}{4}\)</span></td>
<td><span class="math">\(\frac{3}{20}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\frac{3}{2}, \frac{1}{2}\)</span></td>
<td><span class="math">\(\frac{1}{4}\)</span></td>
<td><span class="math">\(\frac{3}{20}\)</span></td>
<td><span class="math">\(-\frac{1}{4}\)</span></td>
<td><span class="math">\(-\frac{3}{20}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\frac{3}{2}, \frac{3}{2}\)</span></td>
<td><span class="math">\(\frac{1}{4}\)</span></td>
<td><span class="math">\(\frac{9}{20}\)</span></td>
<td><span class="math">\(\frac{1}{4}\)</span></td>
<td><span class="math">\(\frac{1}{20}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math">\(\frac{1}{2}, -\frac{1}{2}\)</span></td>
<td><span class="math">\(\frac{1}{2}\)</span></td>
<td><span class="math">\(-\frac{1}{2}\)</span></td>
<td><span class="math">\(0\)</span></td>
<td><span class="math">\(0\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math">\(\frac{1}{2}, \frac{1}{2}\)</span></td>
<td><span class="math">\(\frac{1}{2}\)</span></td>
<td><span class="math">\(\frac{1}{2}\)</span></td>
<td><span class="math">\(0\)</span></td>
<td><span class="math">\(0\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math">\(I_{j,m}^{(a), \mathrm{tot}}\)</span> yields the total intensity of a certain state. In order to calculate the line shape
the energy position of each line has to be known as well as its shape function. The energy splitting, <span class="math">\(E_s\)</span>,
between different <span class="math">\(m\)</span> is given by exchange field, <span class="math">\(H_s\)</span> as</p>
<div class="math">
\[E_s = H_s m \frac{j(j+1) + s(s+1) - l(l+1)}{2j(j+1)}.\]</div>
<p>Also, the edge energies of the <span class="math">\(L_2\)</span> and <span class="math">\(L_3\)</span> has to be known. This can be implemented as defining the
energy of the <span class="math">\(L_3\)</span> edge, <span class="math">\(E_{L_3}\)</span>, and the 2p-SOC which yields the splitting between the levels,
<span class="math">\(E_\mathrm{SOC}\)</span>.</p>
<p>The shape of a atomic transition will depend on the lifetime of the excitation and consequently it will have an
lorentz shape. However, other broadening mechanisms exists as well. For example, the band structure will yield a
broadening
that corresponds to the band structure. This has successfully been modelled as a linear superposition of different
gaussian contributions [Gold04]. Instrumental resolution is also usually considered to have a gaussian distribution.
The Voigt function which is the convolution between a lorentzian function and a gaussian function is therefore suitable
to use.</p>
</div>
<div class="section" id="references">
<h2>References:<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="laan97" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Laan97]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>, <a class="fn-backref" href="#id5">3</a>)</em> <p>Laan, G. Van Der. (1997). Line shape of 2p magnetic-x-ray-dichroism spectra in 3d metallic systems.
Physical Review B, 55(13), 8086–8089.</p>
<p class="last">Laan, G. (1997). The role of the spin polarization in x-ray magnetic circular dichroism spectra of
itinerant magnets. Journal of Physics: Condensed Matter, 9, L259–L265.</p>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gold04" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Gold04]</a></td><td>Gold, S., Bayer, a., &amp; Goering, E. (2004). Ground-State-Moment-Analysis: A quantitative tool for X-ray
magnetic circular dichroism analysis for 3d transition metals. Applied Physics A: Materials Science &amp; Processing,
78(6), 855–865. doi:10.1007/s00339-003-2442-8</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dorfler06" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Dörfler06]</a></td><td><p class="first">Dörfler, Fabian (2006). Contributions to the theory of x-ray magnetic dichroism. Max-Planck-Institut fur
Metallforschung Stuttgart and Universität Stuttgart. PhD thesis.</p>
<p class="last">Dörfler, F., &amp; Fähnle, M. (2006). Theoretical justification of ground-state moment analysis of magnetic
dichroic x-ray absorption spectra for 3d transition metals. Phys. Rev. B, 74(22),
224424. doi:10.1103/PhysRevB.74.224424</p>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="stone80" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[Stone80]</a></td><td>Stone, A and Wood, (1980). C. Comp. Phys. Comm., 21 , 195.</td></tr>
</tbody>
</table>
<dl class="class">
<dt id="genx.models.lib.xmcd_moment.Background2p">
<em class="property">class </em><code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">Background2p</code><span class="sig-paren">(</span><em>parent</em>, <em>element</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Background2p" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to model the 2p background spectra, the non-resonant part, with a smoothed step function.</p>
<blockquote>
<div><dl class="docutils">
<dt>Parameters:</dt>
<dd><blockquote class="first">
<div><p>el3 (float): Energy position of the L3 edge.
sigma (float): The width of the error function (std in eV).
pre_edge (float): The width of the pre edge region (eV).
post_edge (float): The width of the post edge region (eV).
de (float): The sampling spacing for the recalcualted table (eV).
kk_emax (float): The maximum energy values taken from the tables in eV. The value should be well</p>
<blockquote>
<div>above the K edge.</div></blockquote>
<dl class="docutils">
<dt>element (string): The element to which the background applies. Used to find theoretical f values (from the nist</dt>
<dd>database), position of the L2/L3 edge and Z (number of electrons).</dd>
</dl>
<p>parent (Spectra2p): The parent spectra to which the Background applies.</p>
</div></blockquote>
<p class="last">The background, B, is modelled with two error function according to</p>
</dd>
</dl>
<div class="math">
\[B = a_0 + a_1 e + (a_2 + a_3 e) \Phi(e, e_l3) + (a_4 + a_5 e) \Phi(e, e_l2),\]</div>
<p>where</p>
<div class="math">
\[\Phi(e, e_0) =\]</div>
</div></blockquote>
<p>rac{1}{2}left( 1 + mathrm{erf}left(
rac{e - e_0}{sqrt(2) sigma
ight)
ight).</p>
<blockquote>
<div><p>This function is used to up-sample the theoretical, tabulates, f2 values for the spectral region (the L2/L3 within
the pre and post edge values) to a point spacing of de. This data then replaces the data in the tabulated f2 values
and a Kramer-Kronig (KK) transform is conducted to get the f1 values. Note that the tabulated values in the class
contains a moved L2/L3 edge since this removes the necessity of conducting a full KK transform when a new background
is calculated. The KK transform fulfill the superposition principle. The KK transform conducted when the complex
are calculated, which is the difference between the tabulated and the current, over the spectral region only.</p>
<p>Note that this implementation does incorporates exchange split levels.</p>
<dl class="docutils">
<dt>The parameters relating to KK transform are:</dt>
<dd><ul class="first last simple">
<li>sigma_tab (float): The width of the error function applied to the table (std in eV), defualt value 1 eV.</li>
<li>edge_offset_tab (float): The offset of the stored tabulated data to the read data (eV), defualt value 40 eV.</li>
</ul>
</dd>
<dt>Fitting parameters</dt>
<dd><ul class="first last simple">
<li>el3</li>
<li>sigma</li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Background2p.calc_abs">
<code class="descname">calc_abs</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Background2p.calc_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the absorption background function for the given energies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>energy</strong> (<em>array of floats</em>) &#8211; Energy points in eV.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Absorption, the complex part of the scattering length.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Abs (array of floats)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Background2p.calc_f">
<code class="descname">calc_f</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Background2p.calc_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the complex background scattering length for energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>energy</strong> (<em>array of floats</em>) &#8211; Energy points where to evaluate f</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Scattering length.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">f (array of complex)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Background2p.create_bkg_f1">
<code class="descname">create_bkg_f1</code><span class="sig-paren">(</span><em>e_l3</em>, <em>e_l2</em>, <em>e_tab</em>, <em>f2_tab</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Background2p.create_bkg_f1" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the background f1 data to be used in later calculations.</p>
<p>The method will fit the tabulated f2 value to analytical function and replace the step in the table with
a error function (with a width (std) given by the parameter <code class="docutils literal"><span class="pre">sigma_tab</span></code>)
whose steps are offset <code class="docutils literal"><span class="pre">edge_offset_tab</span></code> eV. This function is then regridded with a step size of <code class="docutils literal"><span class="pre">de</span></code>
on a range of <code class="docutils literal"><span class="pre">e_l3</span> <span class="pre">+</span> <span class="pre">pre_edge``and</span> <span class="pre">``e_l2</span> <span class="pre">-</span> <span class="pre">pre_edge</span></code>. These values are then merged into the original
f2 values in the <code class="docutils literal"><span class="pre">f2_tab``array.</span> <span class="pre">This</span> <span class="pre">array</span> <span class="pre">is</span> <span class="pre">Kramer-Kronig</span> <span class="pre">transformed</span> <span class="pre">to</span> <span class="pre">yield</span> <span class="pre">the</span> <span class="pre">corresponding</span> <span class="pre">f1</span> <span class="pre">values.</span>
<span class="pre">The</span> <span class="pre">values</span> <span class="pre">are</span> <span class="pre">stored</span> <span class="pre">as</span> <span class="pre">``f1_tab</span></code> and <code class="docutils literal"><span class="pre">f2_tab</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>e_l3</strong> (<em>float</em>) &#8211; Position of the L3 edge in eV.</li>
<li><strong>e_l2</strong> (<em>float</em>) &#8211; Position of the L2 edge in eV.</li>
<li><strong>e_tab</strong> (<em>array of floats</em>) &#8211; The scattering length tables energy values in eV.</li>
<li><strong>f2_tab</strong> (<em>array of floats</em>) &#8211; The f2 values of the scattering length tables.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Nothing.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Background2p.fit_table_data">
<code class="descname">fit_table_data</code><span class="sig-paren">(</span><em>e_tab</em>, <em>f2_tab</em>, <em>pre_slice</em>, <em>between_slice</em>, <em>post_slice</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Background2p.fit_table_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the L2 and L3 steps in tabular data to parametrise the spectra in the fitting range.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>e_tab</strong> (<em>array of floats</em>) &#8211; The scattering length tables energy values in eV.</li>
<li><strong>f2_tab</strong> (<em>array of floats</em>) &#8211; The f2 values of the scattering length tables.</li>
<li><strong>pre_slice</strong> (<em>slice</em>) &#8211; A slice object that contain the pre edge data.</li>
<li><strong>between_slice</strong> (<em>slice</em>) &#8211; A slice object that indexes the region between the L2 and L3 edge.</li>
<li><strong>post_slice</strong> (<em>slice</em>) &#8211; A slice object that indexes the region post edge region.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A function of the form f(e, e_l3, e_l2, sigma).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">f (function)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Background2p.load_nff_file">
<code class="descname">load_nff_file</code><span class="sig-paren">(</span><em>file_path</em>, <em>e_l3_tab</em>, <em>e_l2_tab</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Background2p.load_nff_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an nff (scattering length table) file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>file_path</strong> (<em>string</em>) &#8211; Path to file.</li>
<li><strong>e_l3_tab</strong> (<em>float</em>) &#8211; Position of the L3 edge in the table (eV).</li>
<li><strong>e_l2_tab</strong> (<em>float</em>) &#8211; Position of the L2 edge in the table (eV).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Nothing.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="genx.models.lib.xmcd_moment.ModelGoering">
<em class="property">class </em><code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">ModelGoering</code><span class="sig-paren">(</span><em>w000=0.0</em>, <em>w110=0.0</em>, <em>w101=0.0</em>, <em>w011=0.0</em>, <em>w211=0.0</em>, <em>w202=0.0</em>, <em>gamma=0.5</em>, <em>sigma=0.1</em>, <em>soc=0.0</em>, <em>hs=0.0</em>, <em>e_L3=0.0</em>, <em>valid_e=710.0</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.ModelGoering" title="Permalink to this definition">¶</a></dt>
<dd><p>A fit model to simulate one xmcd spectral moment of a p_3/2, p_1/2 absorption edge.</p>
<dl class="method">
<dt id="genx.models.lib.xmcd_moment.ModelGoering.calc_fm1">
<code class="descname">calc_fm1</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.ModelGoering.calc_fm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the fm1 structure factor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e</strong> &#8211; The energy points where fm1 is evaluated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">fm1 scattering factor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.ModelGoering.xmcd">
<code class="descname">xmcd</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.ModelGoering.xmcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the xmcd absorption signal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e</strong> &#8211; The energy where the xmcd is calculated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">xmcd signal</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="genx.models.lib.xmcd_moment.Spectrum2p">
<em class="property">class </em><code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">Spectrum2p</code><span class="sig-paren">(</span><em>hs=0.0</em>, <em>soc=0.0</em>, <em>gsm=((0</em>, <em>0</em>, <em>0)</em>, <em>(1</em>, <em>1</em>, <em>0)</em>, <em>(1</em>, <em>0</em>, <em>1)</em>, <em>(0</em>, <em>1</em>, <em>1)</em>, <em>(2</em>, <em>1</em>, <em>1)</em>, <em>(2</em>, <em>0</em>, <em>2))</em>, <em>norm_denom=(1.0</em>, <em>1.0</em>, <em>1</em>, <em>1.0</em>, <em>1.0</em>, <em>1.0)</em>, <em>valid_e=700.0</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Spectrum2p" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to model the lineshape of a 2p level including dichroism.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hs</strong> (<em>float</em>) &#8211; The exchange field (eV).</li>
<li><strong>soc</strong> (<em>float</em>) &#8211; The spin orbit coupling (eV).</li>
<li><strong>gsm</strong> (<em>list of tuples 3xint</em>) &#8211; The ground state moments used in the spectra, a list of 3 int tuples.</li>
<li><strong>norm_denom</strong> (<em>list of floats</em>) &#8211; The normalisation denominators for the ground
state moments (same order as gsm).</li>
<li><strong>valid_e</strong> (<em>float</em>) &#8211; Energy (eV) where a validation (type check) of the function is made when the scattering
lengths are inserted in a validator (used in the Reflectivity plugin).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This class contains spectra-wide parameters for the model. It also contains the
scattering lengths that can be used in a reflectivity model. The scattering lengths functions are</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">fres</span></code> - The resonant (unpolarised) part of the scattering length.</li>
<li><code class="docutils literal"><span class="pre">fm1</span></code> - The dicroic part of the scattering length. The imaginary part correspond to the XMCD signal.</li>
<li><code class="docutils literal"><span class="pre">fm2</span></code> - The linear dichroic signal. The imaginary part correspond to the XMLD signal.</li>
</ul>
<p>The wXYZs from the SpectrumComponent class is scaled according to the following formula</p>
<div class="math">
\[w^{xyxz}_\mathrm{eff} = w^{xyz}_\mathrm{SpectrumComponent} w^{xyz}_\mathrm{Spectrum2p}/\mathrm{norm\_denom}.\]</div>
<p>The subscripts on the right hand side denote which class the w parameter belongs to. The use for these normalisation
could be to define normalisation factors (norm_denom) from reference spectra with known values of number of holes,
spin magnetic moment and orbital magnetic moment. While keeping the spectral shape constant, constant
<span class="math">\(w^{xyz}_\mathrm{SpectrumComponent}\)</span> the overall spectra can be scaled to change the different values with the
parameters <span class="math">\(w^{xyz}_\mathrm{Spectrum2p}\)</span>.</p>
<dl class="docutils">
<dt>Fitting Parameters</dt>
<dd><ul class="first last simple">
<li>hs(float) - The exchange field that causes the levels to split (eV).</li>
<li>soc(float) - The spin orbit coupling (distance between L_2 and L_3 edge (eV).</li>
<li>wXYZ(float) - The different global ground state moments (X, Y and Z are integers.</li>
</ul>
</dd>
<dt>Member functions for simulation</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">add_component</span></code> - Add an component (ground state moment set) to the spectra.</li>
<li><code class="docutils literal"><span class="pre">calc_spectra</span></code> - Calculates a spectra (<code class="docutils literal"><span class="pre">fm1</span></code>, <code class="docutils literal"><span class="pre">fres</span></code> and <code class="docutils literal"><span class="pre">fm2</span></code> can be used as well).</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Spectrum2p.calc_fm1">
<code class="descname">calc_fm1</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Spectrum2p.calc_fm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the circular dirchroic compenet.</p>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Spectrum2p.calc_fm2">
<code class="descname">calc_fm2</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Spectrum2p.calc_fm2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the linear dichroic component.</p>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Spectrum2p.calc_fres">
<code class="descname">calc_fres</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Spectrum2p.calc_fres" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the isotropic resonant scattering length.</p>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Spectrum2p.calc_spectra">
<code class="descname">calc_spectra</code><span class="sig-paren">(</span><em>energy</em>, <em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Spectrum2p.calc_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total spectra.</p>
<p>Sums up all contributions from the different components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>energy</strong> (<em>float</em><em> or </em><em>array</em>) &#8211; The energy where to evaluate the spectra.</li>
<li><strong>a</strong> (<em>int</em>) &#8211; Number representing the exciting polarization.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">spectra(complex array or complex)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="genx.models.lib.xmcd_moment.Spectrum2p.calc_spectra_comp">
<code class="descname">calc_spectra_comp</code><span class="sig-paren">(</span><em>energy</em>, <em>comp</em>, <em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.Spectrum2p.calc_spectra_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the spectra from one component</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>e</strong> (<em>float array</em>) &#8211; The energy values where the spectra are to be calcualted.</li>
<li><strong>comp</strong> (<em>SpectralComponent</em>) &#8211; The spectral component.</li>
<li><strong>a</strong> (<em>int</em>) &#8211; The polarization of the exciting light.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">spectra (complex np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="genx.models.lib.xmcd_moment.SpectrumComponent">
<em class="property">class </em><code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">SpectrumComponent</code><span class="sig-paren">(</span><em>spectra</em>, <em>gsm</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.SpectrumComponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to keep the variables of a spectral component.</p>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.calc_de">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">calc_de</code><span class="sig-paren">(</span><em>hs</em>, <em>j</em>, <em>l</em>, <em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.calc_de" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the energy spacing between different m levels due to the exchange field hs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hs</strong> (<em>float</em>) &#8211; The exchange filed in eV</li>
<li><strong>j</strong> (<em>float</em>) &#8211; The j quantum number of the core level</li>
<li><strong>l</strong> (<em>float</em>) &#8211; The l quantum number of the core level</li>
<li><strong>s</strong> (<em>float</em>) &#8211; The s quatum number of the core level</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The energy spacing</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">de(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.calc_h">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">calc_h</code><span class="sig-paren">(</span><em>xyz</em>, <em>j2</em>, <em>m2</em>, <em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.calc_h" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the h values for the given parameters.</p>
<p>For a full description see the Theory section in module documentation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xyz</strong> (<em>tuple</em><em>, </em><em>3 int</em>) &#8211; A tuple indicating the ground state moment.</li>
<li><strong>j2</strong> (<em>int</em>) &#8211; The j quantum number multiplied by 2 (value 3 or 1).</li>
<li><strong>m2</strong> (<em>int</em>) &#8211; The m quantum number multiplied by 2 (value [-j2 .. j2]).</li>
<li><strong>a</strong> (<em>int</em>) &#8211; The polarisation of the exciting light.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Transition probability of the given state with ground state moment 1.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">h (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.create_h_table">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">create_h_table</code><span class="sig-paren">(</span><em>j2</em>, <em>xyz_values</em>, <em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.create_h_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an h values for the given j level&#8217;s m subleves for the different xyz values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>j2</strong> (<em>int</em>) &#8211; 2*j where j is the j quatum number for the ground state.</li>
<li><strong>xyz_values</strong> (<em>list</em>) &#8211; A list of three int tuples denoting the ground state moment.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">h_table(array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.create_interval">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">create_interval</code><span class="sig-paren">(</span><em>x</em>, <em>x_min</em>, <em>x_max</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.create_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a closed slice [x_min, x_max] where x_min &lt; x[slice] &lt; x_max.</p>
<blockquote>
<div>x:
x_min:
x_max:</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">slice object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.kk_int">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">kk_int</code><span class="sig-paren">(</span><em>e</em>, <em>f2</em>, <em>Z=0</em>, <em>e_min=None</em>, <em>e_max=None</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.kk_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the Kramer Kronig transform from f2 to f1</p>
<p>If the parameters e_min or e_max is given the evaluation range is reduced so that the final size of
f1kk is reduced. The Kramer-Kronig transformation is conducted as suggested by the Newville in the DIFFKK manual.
The integrand is defined as in the XOP data booklet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>e</strong> (<em>array of floats</em>) &#8211; Energy values of the values found in f2 (eV).</li>
<li><strong>f2</strong> (<em>array of floats</em>) &#8211; The imaginary part of the scattering length (electrons)</li>
<li><strong>Z</strong> (<em>int</em>) &#8211; The number of electrons of the element, (electrons).</li>
<li><strong>e_min</strong> (<em>float</em>) &#8211; The minimum value of the returned real part of f.</li>
<li><strong>e_max</strong> (<em>float</em>) &#8211; The maximum value of the returned real part of f.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The energy values for the calculated f1 (eV).
array of floats: The real part of the scattering length, f1, (electrons).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of floats</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Newville, M. and Olmsted Cross J. DIFFKK Manual. Downloaded from <a class="reference external" href="http://cars9.uchicago.edu/dafs/diffkk/diffkk.pdf">http://cars9.uchicago.edu/dafs/diffkk/diffkk.pdf</a>
20140902.</p>
<p>X-ray data booklet, CXRO, Lawrence Berkley National Laboratory, Downloaded from <a class="reference external" href="http://xdb.lbl.gov">http://xdb.lbl.gov</a> 20140902.</p>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.kk_int_old">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">kk_int_old</code><span class="sig-paren">(</span><em>e_new</em>, <em>e</em>, <em>f2</em>, <em>Z</em>, <em>offset=0.1</em>, <em>offset_outer=1</em>, <em>e_step=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.kk_int_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Original Kramer-Kronig transform - a slower implementation of kk_int</p>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.step_func">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">step_func</code><span class="sig-paren">(</span><em>x</em>, <em>x0</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.step_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the step funciton (erf) of the L2/L3 edges</p>
<blockquote>
<div>x (array of floats):
x0 (float):
sigma (float):</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#genx.models.lib.xmcd_moment.step_func" title="genx.models.lib.xmcd_moment.step_func">step_func</a> (array of floats)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.test_h">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">test_h</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.test_h" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the calculations with previously tabulated values.</p>
<p>Validate the calculation of the u values by comparing the h values calculated by this module
with the ones calculated from the (Gold, 2004)</p>
<p class="rubric">References</p>
<p>Gold, S., Bayer, a., &amp; Goering, E. (2004). Ground-State-Moment-Analysis: A quantitative tool for X-ray
magnetic circular dichroism analysis for 3d transition metals. Applied Physics A: Materials Science &amp; Processing,
78(6), 855–865. doi:10.1007/s00339-003-2442-8</p>
</dd></dl>

<dl class="function">
<dt id="genx.models.lib.xmcd_moment.voigt">
<code class="descclassname">genx.models.lib.xmcd_moment.</code><code class="descname">voigt</code><span class="sig-paren">(</span><em>x</em>, <em>x_0</em>, <em>gamma</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#genx.models.lib.xmcd_moment.voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>The complex Voigt function (a convolution of a Lorentzian and a Gaussian function).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array</em><em> or </em><em>float</em>) &#8211; Independent value where to evaluate the Voigt function.</li>
<li><strong>x_0</strong> (<em>float</em><em> or </em><em>array</em>) &#8211; Centre of the peak.</li>
<li><strong>gamma</strong> (<em>float</em><em> or </em><em>array</em>) &#8211; Scale parameter (HWHM) of the Lorentzian part.</li>
<li><strong>sigma</strong> (<em>float</em><em> or </em><em>array</em>) &#8211; The standard deviation of the Gaussian part.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The complex Voigt function evaluated at x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">V(complex array)</p>
</td>
</tr>
</tbody>
</table>
<p>The complex Voigt function is defined as</p>
<div class="math">
\[V(x,\sigma,\gamma) = w(z)/(\sigma*sqrt(2*pi)),\]</div>
<p>where</p>
<div class="math">
\[z = (x+i*\gamma)/(\sigma*sqrt(2)).\]</div>
<p><span class="math">\(\gamma\)</span> is the half width at half max of the Lorentizan component and <span class="math">\(sigma\)</span> is the standard deviation
of the Gaussian component.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Voigt_profile">http://en.wikipedia.org/wiki/Voigt_profile</a></p>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/development/moment_analysis.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2017, Matts Björck.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>